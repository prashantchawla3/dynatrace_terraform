resource "dynatrace_vulnerability_settings" "settings" {
  count = length(var.vulnerability_settings)

  enable_code_level_vulnerability_detection = var.vulnerability_settings[count.index].enable_code_level_vulnerability_detection
  enable_runtime_vulnerability_detection    = var.vulnerability_settings[count.index].enable_runtime_vulnerability_detection
  global_monitoring_mode_java               = var.vulnerability_settings[count.index].global_monitoring_mode_java

  technologies {
    enable_dot_net         = var.vulnerability_settings[count.index].enable_dot_net
    enable_dot_net_runtime = var.vulnerability_settings[count.index].enable_dot_net_runtime
    enable_go              = var.vulnerability_settings[count.index].enable_go
    enable_java            = var.vulnerability_settings[count.index].enable_java
    enable_java_runtime    = var.vulnerability_settings[count.index].enable_java_runtime
    enable_kubernetes      = var.vulnerability_settings[count.index].enable_kubernetes
    enable_node_js         = var.vulnerability_settings[count.index].enable_node_js
    enable_node_js_runtime = var.vulnerability_settings[count.index].enable_node_js_runtime
    enable_php             = var.vulnerability_settings[count.index].enable_php
  }
}